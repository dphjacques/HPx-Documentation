

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Personal Edition 10.0.0.105">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>Porosity (scaling factor of water content)</title>
  <meta name="description" content="" /> 
  <meta name="keywords" content="scaling factor for the water content,porosity,Porosity,scaling factor of the water content">



  
  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Porosity (scaling factor of water content)">
  <meta name="twitter:description" content="">

  <!-- Open Graph data -->
  <meta property="og:title" content="Porosity (scaling factor of water content)" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="HPx" /> 

  <!-- Bootstrap CSS -->
  <link href="vendors/bootstrap-5.3.7/bootstrap.min.css" rel="stylesheet"/>
  <link href="vendors/bootstrap-icons-1.13.1/bootstrap-icons.min.css" rel="stylesheet"/>

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-dark-blue.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 350px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 350px} body.md-nav-expanded header { padding-left: 364px} }</style>
  <style type="text/css">.navigation #inline-toc { width: auto !important}</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  

  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="visually-hidden">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>HPx</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close" role="presentation"> 
        <button class="hnd-toggle btn btn-default" aria-label="close">
          <span class="bi bi-x" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="nav-item tab">
            <a href="#contents" id="tab-contents" class="nav-link active" role="tab" data-bs-toggle="tab" data-bs-target="#contents" aria-controls="contents" aria-selected="true">
                <i class="bi bi-list-ul"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="nav-item tab">
            <a href="#index" id="tab-index" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#index" aria-controls="index" aria-selected="false">
                <i class="bi bi-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="nav-item tab">
            <a href="#search" id="tab-search" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#search" aria-controls="search" aria-selected="false">
                <i class="bi bi-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." aria-label="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit" aria-label="Search...">
                      <span class="bi bi-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="Porosityscalingfactorofwatercont"
		  data-hnd-context="118"
		  data-hnd-title="Porosity (scaling factor of water content)"
		>
            
                <div class="navigation">
                    <ol class="breadcrumb">
                        <li><a href="HowTo.html">How To...</a></li><li><a href="Changetransportproperties.html">Change transport properties</a></li>
                    </ol>
                    <div class="nav-arrows">
                        <div class="btn-group btn-group" role="group"><div class="btn-group"><button type="button" title="In this page..." class="btn btn-link dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="bi bi-three-dots" aria-hidden="true"></span></button><ul id="inline-toc" class="dropdown-menu dropdown-menu-right"></ul></div><a class="btn btn-default" href="Changetransportproperties.html" title="Change transport properties" role="button"><span class="bi bi-chevron-up" aria-hidden="true"></span></a><a class="btn btn-default" href="Changetransportproperties.html" title="Change transport properties" role="button"><span class="bi bi-chevron-left" aria-hidden="true"></span></a><a class="btn btn-default" href="Hydraulicconductivityscalingfact.html" title="Hydraulic conductivity (scaling factor of the hydraulic conductivity)" role="button"><span class="bi bi-chevron-right" aria-hidden="true"></span></a></div>
                    </div>
                </div> 
            

            <a id="main-content"></a>

            <h2>Porosity (scaling factor of water content)</h2>

            <div class="main-content">
                
<p class="rvps2"><span class="rvts6">In the water flow and solute transport model, the actual porosity (actual saturated water content) as a function of the spatial coordinates and times is calculated based on the reference saturated and residual water content for the specific material type of the node and the nodal value of </span><a class="rvts21" href="ScalingFactors.html">the scaling factor for the water content</a><span class="rvts6"> </span><span class="rvts162">α</span><span class="rvts163">θ</span><span class="rvts161"> [-].&nbsp;</span></p>
<p class="rvps2"><span class="rvts88"><br/></span></p>
<p class="rvps2"><span class="rvts88">On this page, we illustrate how:</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <ul style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: circle;">
  <li class="rvps4 noindent"><span class="rvts88">you can calculate porosity using script functions</span></li>
  <li class="rvps4 noindent"><span class="rvts88">you can calculate and update the scaling factors of the water content</span></li>
  <li class="rvps4 noindent"><span class="rvts88">you define the porosity and scaling factors of the water content at the initial time</span></li>
  <li class="rvps4 noindent"><span class="rvts88">you account for evolving porosity and scaling factors with time in the water flow and solute transport model</span></li>
 </ul>
</ul>
<p class="rvps4"><span class="rvts88"><br/></span></p>
<p class="rvps4"><span class="rvts88"><br/></span></p>
<h3 class="rvps22"><span class="rvts0"><span class="rvts52">Calculate porosity</span></span></h3>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">HPx does not automatically calculate the change in porosity when the volume of solid phases changes. The user needs to explicitly define a script that calculates the porosity based on the volume of the different solid phases. Typically, the sum of the volume of the solid phases is given by:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img alt="" style="padding : 1px;" src="lib/Solid%20phase%20content%20Def%201.gif"></p>
<p class="rvps2"><span class="rvts88">where &nbsp;</span></p>
<div class="rvps42">
<table width="100%" style="border-width: 0px; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="padding: 1px; width: 110px;">
   <p class="rvps2"><span class="rvts115">ε</span><span class="rvts81">s</span></p>
  </td>
  <td style="padding: 1px; width: 953px;">
   <p class="rvps2"><span class="rvts6">Solid phase content</span></p>
  </td>
 </tr>
 <tr style="vertical-align: top;">
  <td style="padding: 1px; width: 110px;">
   <p class="rvps2"><span class="rvts82">t</span></p>
  </td>
  <td style="padding: 1px; width: 953px;">
   <p class="rvps2"><span class="rvts6">Time</span></p>
  </td>
 </tr>
 <tr style="vertical-align: top;">
  <td style="padding: 1px; width: 110px;">
   <p class="rvps2"><span class="rvts115">ε</span><span class="rvts81">s0</span></p>
  </td>
  <td style="padding: 1px; width: 953px;">
   <p class="rvps2"><span class="rvts6">Inert solid phase content&nbsp;</span></p>
  </td>
 </tr>
 <tr style="vertical-align: top;">
  <td style="padding: 1px; width: 110px;">
   <p class="rvps2"><span class="rvts82">M</span><span class="rvts110">i</span></p>
  </td>
  <td style="padding: 1px; width: 953px;">
   <p class="rvps2"><span class="rvts6">Moles of the </span><span class="rvts82">i</span><span class="rvts6">th mineral (mole/dm³)</span></p>
  </td>
 </tr>
 <tr style="vertical-align: top;">
  <td style="padding: 1px; width: 110px;">
   <p class="rvps2"><span class="rvts82">V</span><span class="rvts110">i</span></p>
  </td>
  <td style="padding: 1px; width: 953px;">
   <p class="rvps2"><span class="rvts6">Molar volume of the </span><span class="rvts82">i</span><span class="rvts6">th mineral (cm³/mole)</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The volume that is used in the geochemical calculation in HPx for each node is 1 dm³. The porosity, </span><span class="rvts115">η</span><span class="rvts6">, is then given as:&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><img alt="" style="padding : 1px;" src="lib/Porosity%20Def%201.gif"></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts11">Note: </span><span class="rvts6">in the HYDRUS codes, the porosity is defined as the saturated water content, </span><span class="rvts115">θ</span><span class="rvts81">s</span><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><a name="sys"></a><span class="rvts6">One option is to use the script function </span><a class="rvts94" href="sys.html">sys()</a><span class="rvts6">. Hereunder, an example is given for a case in which all solid phases are minerals in equilibrium with the aqueous solution (defined with </span><a class="rvts55" href="EQUILIBRIUM_PHASES.html">equilibrium_phases</a><span class="rvts6">) and assuming that the database contains information of the mineral volumes (</span><a class="rvts56" href="vm.html">-vm</a><span class="rvts6"> in </span><a class="rvts55" href="PHASES.html">PHASES</a><span class="rvts6">).&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><span class="rvts59">MyBasic]</span></p>
   <p class="rvps4"><span class="rvts59">VolumeSolidPhases = 0</span></p>
   <p class="rvps4"><span class="rvts59">res=</span><span class="rvts84">sys</span><span class="rvts59">("equi","count","name$","type$","moles")</span></p>
   <p class="rvps4"><span class="rvts84">if</span><span class="rvts59">(count&gt;0) </span><span class="rvts84">then</span></p>
   <p class="rvps4"><span class="rvts59">&nbsp; &nbsp;</span><span class="rvts84">for</span><span class="rvts59"> i = 1 </span><span class="rvts84">to</span><span class="rvts59"> count</span></p>
   <p class="rvps4"><span class="rvts59">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts84">if</span><span class="rvts59"> (</span><a class="rvts94" href="stringfind.html">string.find</a><span class="rvts59">(name$(i),"(g)")=-1) then</span></p>
   <p class="rvps4"><span class="rvts59">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VolumeSolidPhases = VolumeSolidPhases + </span><a class="rvts94" href="equi.html">equi</a><span class="rvts59">(name$(i))*</span><a class="rvts94" href="phase_vm.html">phase_vm</a><span class="rvts59">(name$(i))</span></p>
   <p class="rvps4"><span class="rvts59">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts84">endif</span></p>
   <p class="rvps4"><span class="rvts59">&nbsp; &nbsp;</span><span class="rvts84">next</span><span class="rvts59">&nbsp;</span></p>
   <p class="rvps4"><span class="rvts84">endif</span></p>
   <p class="rvps4"><span class="rvts59">porosity = 1 - VolumeSolidPhases/1000</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts59"><br/></span></p>
<p class="rvps2"><span class="rvts6">Since the volume used in the geochemical calculations is 1 dm³, the value that is returned by the script function </span><a class="rvts94" href="equi.html">equi()</a><span class="rvts84"> </span><span class="rvts6">has as unit mol / dm³. When </span><a class="rvts94" href="phase_vm.html">phase_vm()</a><span class="rvts6"> has as unit cm³/mol, the unit of </span><a class="rvts94" href="equi.html">equi()</a><span class="rvts6">*</span><a class="rvts94" href="phase_vm.html">phase_vm()</a><span class="rvts6"> is cm³/dm³.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><a name="change_por"></a><span class="rvts6">The porosity of a given node is changed by the script function </span><a class="rvts94" href="change_por.html">change_por()</a><span class="rvts6">:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><span class="rvts59">[MyBasic]</span></p>
   <p class="rvps4"><a class="rvts94" href="change_por.html">change_por</a><span class="rvts59">(porosity)</span></p>
  </td>
 </tr>
</table>
</div>
<h3 class="rvps22"><span class="rvts0"><span class="rvts52">Calculate scaling factor for water content</span></span></h3>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The porosity is transformed to the scaling factor of the water content by the reference residual and saturated water content of the material type in the corresponding node.&nbsp;</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><a name="updatesfwater"></a><span class="rvts6">The most straightforward method is to use </span><a class="rvts94" href="update_sfwater.html">update_sfwater()</a><span class="rvts6">. Assuming that </span><span class="rvts59">porosity</span><span class="rvts6"> is the name of the variable storing the value of the porosity:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><span class="rvts59">[MyBasic]</span></p>
   <p class="rvps4"><span class="rvts84">update_sfwater</span><span class="rvts59">(porosity)</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">Alternatively, the scaling factor of the water content is calculated explicitly using </span><a class="rvts94" href="transprop.html">transprop()</a><span class="rvts6"> and </span><a class="rvts94" href="change_sfwater.html">change_sfwater()</a><span class="rvts6">:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><span class="rvts59">[MyBasic]</span></p>
   <p class="rvps4"><span class="rvts59">ths = </span><span class="rvts84">transprop</span><span class="rvts59">("ths")</span></p>
   <p class="rvps4"><span class="rvts59">thr = </span><span class="rvts84">transprop</span><span class="rvts59">("thr")</span></p>
   <p class="rvps4"><span class="rvts59">sfwc = (porosity - thr) / (ths - thr)</span></p>
   <p class="rvps4"><span class="rvts84">change_sfwater</span><span class="rvts59">(sfwc)</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<h3 class="rvps22"><span class="rvts0"><span class="rvts52">Setting the porosity and scaling factor for water content at the initial time</span></span></h3>
<p class="rvps2"><span class="rvts161"><br/></span></p>
<p class="rvps2"><span class="rvts88">The reference saturated and residual water content are time-invariant, material dependent variables. The reference saturated and residual water content for a given material type are defined in the </span><span class="rvts166">Water Flow - Soil Hydraulic Parameters</span><span class="rvts88"> pre-processing dialogue window of the HYDRUS graphical user interface (Qs and Qr in the figure below)</span></p>
<p class="rvps2"><span class="rvts161"><br/></span></p>
<p class="rvps3"><span class="rvts161">&nbsp;</span><img alt="" style="width : 596px; height : 301px; padding : 1px;" src="lib/HYDRUS%20-%20Pre-processing%20-%20Water%20Flow%20Parameters%20-%20Default.png"></p>
<p class="rvps3"><span class="rvts161"><br/></span></p>
<p class="rvps3"><span class="rvts161"><br/></span></p>
<p class="rvps2"><span class="rvts88">The initial values of the scaling factor of the water content can be set in following ways:</span></p>
<p class="rvps2"><span class="rvts88"><br/></span></p>
<p class="rvps4"><span class="rvts6"></span><span class="rvts168">The </span><span class="rvts167">Soil Profile - Graphical Editor</span><span class="rvts168"> or </span><span class="rvts167">Soil Profile - Summary </span><span class="rvts168">pre-processing dialogue windows of the HYDRUS graphical user interface</span></p>
<p class="rvps4"><span class="rvts168"><br/></span></p>
<p class="rvps29"><span class="rvts88">Via the </span><span class="rvts166">Soil Profile - Graphical Editor</span><span class="rvts167">, </span><span class="rvts88">use following commands:</span></p>
<p class="rvps29"><span class="rvts88"><br/></span></p>
<p class="rvps28"><span class="rvts88">Conditions -&gt; Scaling Factor -&gt; Water Content&nbsp;</span></p>
<p class="rvps28"><span class="rvts88">Click Edit condition (see figure below)</span></p>
<p class="rvps28"><span class="rvts88">Select nodes and set the values for selected top and bottom node</span></p>
<p class="rvps31"><span class="rvts88">or</span></p>
<p class="rvps28"><span class="rvts88">Select "scaling factors" from toolbar (see figure below)</span></p>
<p class="rvps28"><span class="rvts88">Select "water content" &nbsp;(see figure belwo</span></p>
<p class="rvps28"><span class="rvts88">Click Edit condition (see figure below)</span></p>
<p class="rvps28"><span class="rvts88">Select nodes and set the values for selected top and bottom node</span></p>
<p class="rvps31"><span class="rvts161"><br/></span></p>
<p class="rvps31"><span class="rvts161"><br/></span></p>
<p class="rvps56"><img alt="" style="width : 485px; height : 83px; padding : 1px;" src="lib/HYDRUS%20-%20Profile%20Editor%20-%20Tool%20bar%20-%20Scaling%20factor.png"></p>
<p class="rvps56"><img alt="" style="width : 154px; height : 406px; padding : 1px;" src="lib/HYDRUS%20-%20Profile%20Editor%20-%20Scaling%20factor%20-%20Select%20quantity.png"></p>
<p class="rvps4"><span class="rvts164"><br/></span></p>
<p class="rvps4"><span class="rvts164"><br/></span></p>
<p class="rvps29"><span class="rvts88">Via the </span><span class="rvts166">Soil Profile - Graphical Summary</span><span class="rvts88">:</span></p>
<p class="rvps31"><span class="rvts88">Nodal values for the scaling factor of the water content at the initial time are defined in the column with heading Dxz (see figure below)</span></p>
<p class="rvps31"><span class="rvts161"><br/></span></p>
<p class="rvps31"><span class="rvts161"><br/></span></p>
<p class="rvps56"><img alt="" style="width : 617px; height : 395px; padding : 1px;" src="lib/HYDRUS%20-%20Pre-processing%20-%20Soil%20Profile%20Summary%20-%20Dxz.png"><span class="rvts6"></span></p>
<p class="rvps56"><span class="rvts164"><br/></span></p>
<p class="rvps4"><span class="rvts6"></span><span class="rvts168">The </span><span class="rvts167">Project Navigator</span><span class="rvts168">&nbsp;</span></p>
<p class="rvps29"><span class="rvts88">Via Domain Properties -&gt; SF - Water Content (see figure below)</span></p>
<p class="rvps56"><img alt="" style="width : 247px; height : 352px; padding : 1px;" src="lib/HYDRUS2D%20-%20Project%20Navigator%20-%20Domain%20Properties%20-%20SF%20-%20Water%20Content.png"><span class="rvts6"></span></p>
<p class="rvps56"><span class="rvts164"><br/></span></p>
<p class="rvps4"><span class="rvts168">Initial calculations using </span><a class="rvts55" href="CALCULATE_VALUES.html">calculated_values</a><span class="rvts168"> in geochemistry input</span></p>
<p class="rvps4"><span class="rvts164"><br/></span></p>
<p class="rvps29"><a name="change_por0"></a><span class="rvts88">With</span><span class="rvts89"> </span><a class="rvts56" href="state1.html">-state initial</a><span class="rvts88">, the script is executed once at the beginning for the transport simulations for each node. This option can be used to calculate the values of the scaling factor of the water content at initial time. The script functions </span><a class="rvts94" href="change_por0.html">change_por0()</a><span class="rvts88"> and </span><a class="rvts94" href="change_por.html">change_por() </a><span class="rvts88">are used to change the value of the porosity and the porosity at the initial time (to keep the initial value). </span><span class="rvts166">Important</span><span class="rvts88">: changing the porosity will not effect the properties in the flow and transport model. To change the transport properties in the flow and transport model, the values of the scaling factor of the water content should be changed. The script functions </span><a class="rvts94" href="update_sfwater.html">update_sfwater()</a><span class="rvts88">,&nbsp;</span><span class="rvts169"> </span><a class="rvts94" href="change_sfwater.html">change_sfwater()</a><span class="rvts88">, and &nbsp;</span><a class="rvts94" href="change_sfwater.html">change_sfwater0()</a><span class="rvts88"> are used to change the values of the scaling factor of the water content; the latter to change the value at the initial time. The first one has (actual) porosity as argument and the scaling factor of the water content is calculated using the reference saturated and residual water content. The other two have the value of the scaling factor of the water content as argument.</span></p>
<p class="rvps29"><span class="rvts88"><br/></span></p>
<p class="rvps29"><span class="rvts88">The example below illustrates how to set the values for porosity and the scaling factor for the water content assuming that the porosity has been calculated and stored as the variable porosity.</span></p>
<p class="rvps29"><span class="rvts161"><br/></span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><a class="rvts55" href="CALCULATE_VALUES.html">calculated_values</a></p>
   <p class="rvps4"><a class="rvts56" href="state1.html">-state</a><span class="rvts89"> initial</span></p>
   <p class="rvps4"><a class="rvts56" href="mybasic.html">-mybasic</a></p>
   <p class="rvps4"><a class="rvts56" href="start.html">-start</a></p>
   <p class="rvps29"><span class="rvts85">#statements to calculate porosity</span></p>
   <p class="rvps29"><span class="rvts85">#...</span></p>
   <p class="rvps29"><span class="rvts85">#porosity = ...</span></p>
   <p class="rvps29"><a class="rvts94" href="change_por0.html">change_por0(</a><a class="rvts165" href="update_sfwater.html">porosity</a><a class="rvts94" href="change_por0.html">)</a></p>
   <p class="rvps29"><a class="rvts94" href="update_sfwater.html">update_sfwater(</a><a class="rvts165" href="update_sfwater.html">porosity</a><a class="rvts94" href="update_sfwater.html">)</a></p>
   <p class="rvps29"><a class="rvts94" href="change_sfwater.html">change_sfwater0(</a><a class="rvts94" href="get_sfwater.html">get_sfwater</a><span class="rvts84">()</span><a class="rvts94" href="change_sfwater.html">)</a></p>
   <p class="rvps4"><a class="rvts56" href="end.html">-end</a></p>
  </td>
 </tr>
</table>
</div>
<h3 class="rvps22"><span class="rvts0"><span class="rvts52">Changing porosity and scaling factor for water content with time</span></span></h3>
<p class="rvps2"><span class="rvts6">To use the updated scaling factor of the water content in the water flow and solute transport model, one needs to:</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 24px; list-style-position: outside; list-style-type: disc;">
 <ul style="text-indent: 0px; padding: 0; margin: 0 0 0 48px; list-style-position: outside; list-style-type: circle;">
  <li class="rvps4 noindent"><span class="rvts6">calculate and update the scaling factor</span></li>
  <li class="rvps4 noindent"><span class="rvts6">indicate that the porosity and the scaling factor of the water content change during the flow and transport simulation</span></li>
 </ul>
</ul>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps4"><span class="rvts82">Calculate and update the scaling factor</span></p>
<p class="rvps29"><span class="rvts6">After the geochemical calculations in each time step and for each node, the porosity change needs to be calculated and the scaling factor needs to be updated. The scripts associated with </span><a class="rvts56" href="state1.html">-state update</a><span class="rvts6"> of the </span><a class="rvts55" href="CALCULATE_VALUES.html">calculated_values</a><span class="rvts168"> </span><span class="rvts88">data block are executed for each node after the geochemical calculations in each time step.&nbsp;</span></p>
<p class="rvps29"><span class="rvts88"><br/></span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><a class="rvts55" href="CALCULATE_VALUES.html">calculated_values</a></p>
   <p class="rvps4"><a class="rvts56" href="state1.html">-state</a><span class="rvts89"> update</span></p>
   <p class="rvps4"><a class="rvts56" href="mybasic.html">-mybasic</a></p>
   <p class="rvps4"><a class="rvts56" href="start.html">-start</a></p>
   <p class="rvps29"><span class="rvts85">#statements to calculate porosity</span></p>
   <p class="rvps29"><span class="rvts85">#...</span></p>
   <p class="rvps29"><span class="rvts85">#porosity = ...</span></p>
   <p class="rvps29"><a class="rvts94" href="change_por0.html">change_por(</a><a class="rvts165" href="update_sfwater.html">porosity</a><a class="rvts94" href="change_por0.html">)</a></p>
   <p class="rvps29"><a class="rvts94" href="update_sfwater.html">update_sfwater(</a><a class="rvts165" href="update_sfwater.html">porosity</a><a class="rvts94" href="update_sfwater.html">)</a></p>
   <p class="rvps4"><a class="rvts56" href="end.html">-end</a></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps4"><span class="rvts168">Indicate evolving using updated transport properties in the flow and transport model</span></p>
<p class="rvps29"><span class="rvts88">To indicate that a changed porosity and scaling factor of the water content has to be used,</span><span class="rvts89"> </span><a class="rvts56" href="update.html">-update hp</a><span class="rvts88"> in </span><a class="rvts55" href="REACTIVE_TRANSPORT.html">reactive_transport</a><span class="rvts88"> is set true.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps28">
<table width="100%" style="border-color: #000000; border-style: solid; border-width: 1px; background-color: #e6e4e3; border-spacing: 2px;">
 <tr style="vertical-align: top;">
  <td style="border-width : 1px; border-color: #000000; border-style: solid; padding: 1px;">
   <p class="rvps4"><a class="rvts55" href="REACTIVE_TRANSPORT.html">reactive_transport</a></p>
   <p class="rvps4"><a class="rvts56" href="update.html">-update hp </a><span class="rvts59">true</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps29"><span class="rvts88"><br/></span></p>
<p class="rvps29"><span class="rvts88">Alternatively, the option for updating hydraulic parameters (check </span><span class="rvts59">Evolving Transport Properties</span><span class="rvts88">; check </span><span class="rvts59">Hydraulic Properties</span><span class="rvts88">) can be selected in the </span><a class="rvts170" href="Evolvingtransportproperties.html">Model options-&gt;Evolving transport properties</a><span class="rvts88"> form of the </span><a class="rvts170" href="Evolvingtransportproperties.html">Reactive Transport Panel</a><span class="rvts88">.</span></p>
<p class="rvps29"><span class="rvts88"><br/></span></p>
<p class="rvps29"><span class="rvts88">If "Use Tortuosity_Factor" is selected in the </span><span class="rvts166">Solute transport - General Information&nbsp;</span><span class="rvts88"> pre-processing dialogue window of the graphical user interface of HYDRUS, the updated porosity is used in the selected </span><a class="rvts170" href="Dispersioncoefficient.html#TortuosityModel">tortuosity model</a><span class="rvts88">. In any case, the updated porosity is used in the solute transport equations via e.g. the calculation of </span><a class="rvts170" href="Dispersioncoefficient.html#DispCoefLiquid">the dispersion coefficient</a><span class="rvts88">.</span></p>
<p class="rvps29"><span class="rvts161"><br/></span></p>
<p class="rvps29"><span class="rvts161"><br/></span></p>
<p class="rvps2"><span class="rvts166">Important:</span><span class="rvts88"> The scaling factors of the water content are only updated with the statements </span><a class="rvts94" href="update_sfwater.html">update_sfwater()</a><a class="rvts111" href="update_sfwater.html"> </a><span class="rvts88">or</span><span class="rvts112"> </span><a class="rvts94" href="change_sfwater.html">change_sfwater()</a><span class="rvts88">. The updated values are only used in the water flow and solute transport model with the identifier </span><a class="rvts56" href="update.html">-update hp </a><span class="rvts59">true</span><span class="rvts88">.</span></p>
<h3 class="rvps22"><span class="rvts0"><span class="rvts52">Examples</span></span></h3>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps4"><span class="rvts37">Examples</span></p>
<p class="rvps29"><span class="rvts6">Section </span><a class="rvts21" href="Reactivetransportwithevolvingtra.html">Reactive transport with evolving transport properties</a></p>
<p class="rvps31"><span class="rvts6"></span><a class="rvts21" href="1D-Equilibriumdissolutionofcalci.html">1D - Equilibrium - Calcite dissolution</a></p>
<p class="rvps31"><a class="rvts21" href="1D-Equilibriumdissolutionofcalc1.html">1D - Equilibrium - Calcite dissolution and gypsum precipitation</a><span class="rvts6"></span></p>
<p class="rvps29"><span class="rvts6"><br/></span></p>
<p class="rvps4"><span class="rvts37">Verification</span></p>
<p class="rvps29"><span class="rvts6">Section </span><a class="rvts21" href="Evolvingpropertiesoftheporousmed.html">Evolving properties of the porous media</a></p>
<p class="rvps31"><span class="rvts6"></span><a class="rvts21" href="Calcitedissolution.html">1D - Kinetics - Calcite dissolution</a><span class="rvts6"></span></p>
<p class="rvps4"><span class="rvts6"><br/></span></p>
<p class="rvps4"><span class="rvts6"></span><span class="rvts6"></span></p>
<p class="rvps5" style="clear: both;"><span class="rvts12">Created with the Personal Edition of HelpNDoc: </span><a class="rvts13" href="https://www.helpndoc.com/step-by-step-guides/how-to-convert-a-hlp-winhelp-help-file-to-a-chm-html-help-help-file/">Leave the tedious WinHelp HLP to CHM conversion process behind with HelpNDoc</a></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2025 by Diederik Jacques. All Rights Reserved.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-bs-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="hndModalLabel"></h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 350px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.7.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-5.3.7/bootstrap.bundle.min.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.11/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script src="_topic_init.js"></script>



</body>

</html>

